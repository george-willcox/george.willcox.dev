<html>
  <head>
    <link rel='stylesheet' href='../../styles/style.css'>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script async src=..\..\scripts\syntax_highlighter.js></script>
    <title>Text Class</title>
  </head>
  <body>

    <div class='Header'>
      <h1>Text Class</h1>
    </div>

    <div class='Navigation'>
      <ul style='list-style-type: none'>
        <li><a href='../../index.html'>Home</a></li>
        <li><a class='active' href='../projects.html'>Projects</a></li>
        <li style='float:right'><a href='../../contact/contact.html'>Contact</a></li>
      </ul>
    </div>

    <div class='Main'>
      <h2>Contents:</h2>

      <ul>
        <li><a href='#introduction'>Introduction</a></li>
        <li><a href='#initialisation'>Initialisation</a></li>
        <li><a href='#changing_settings'>Changing Settings</a></li>
        <li><a href='#changing_text'>Changing Text</a></li>
        <li><a href='#code_download'>Code Download</a></li>
      </ul>

      <h2><a name='introduction' id='introduction'></a>Introduction:</h2>

      <p>
        This is a text class that allows the easy creation and manipulation of text objects, with options for different colours, fonts, alignments, and more.
        One thing to bear in mind when using it, is that if you call <code>Text.set_text()</code> or <code>Text.update_settings()</code> each iteration of the main loop,
        then there will be performance implications from needing to render the text every time.
      </p>

      <h2><a name='initialisation' id='initialisation'></a>Initialisation:</h2>

      <p>
        You can see how we initialise a text object in the <code>__init__()</code> method below, I've also included a simple <code>draw()</code> method too.
        Here we save all of the instance variables, then generate the font type, surface, and rect from these.
        The draw function then simply blits the text surface to the provided surface, which will usually be the screen, at the position dictated by the rect.
      </p>

      <p>
        You can see that I've reluctantly used the <code>exec</code> function here, but I've ensured it's safety by only allowing certain anchors as inputs.
        The available anchors listed in the class variable of the same name are just the different anchors that pygame allows.
        Another way to program this to avoid using <code>exec</code> would be to use if statements to catch each case individually.
        In other languages, like Java and C, a switch statements would be used for this.
      </p>

      <div class="highlight" data-classes="Text,SysFont" data-functions="draw,blit,render"><pre><code>class Text:
    # The anchor points to choose between when creating a text object
    available_anchors = ('topleft', 'bottomleft', 'topright', 'bottomright',
                         'midtop', 'midleft', 'midbottom', 'midright', 'center')
    def __init__(self, position=(0, 0), text='', colour=(0, 0, 0), size=36, font='Lucida Sans', anchor='topleft'):
        self.position = position
        self.size = size
        self.colour = colour
        self.font = font
        self.text = str(text)
        self.anchor = anchor

        # Creates text surface
        self.font_type = pygame.font.SysFont(self.font, self.size)
        self.surface = self.font_type.render(self.text, 1, self.colour)
        self.rect = None

        # Creates rect using the anchor point. Using exec is usually ill-advised, but here it is limited to a few cases.
        if anchor in self.available_anchors:
            try:
                exec('self.rect = self.surface.get_rect(' + self.anchor + '=self.position)')
            except TypeError:
                raise Exception(f'Invalid position {self.position}')
        else:
            raise Exception(f'Invalid anchor point {self.anchor}')
          
    def draw(self, surface):
        surface.blit(self.surface, self.rect)</code></pre></div>

      <h2><a name='changing_settings' id='changing_settings'></a>Changing Settings:</h2>

      <p>
        It can be useful to be able to change the settings of the text object during its lifetime.
        This could be to change what the text says, its size, its colour, or any of its other attributes.
        We can easily do this by making use of variable keyword arguments, and by updating the class's variable dictionary, we can change the specified values.
        We can then just repeat the same process we performed in the initialisation method to recreate the surface and rect to reflect the new variable values.
      </p>

      <div class="highlight" data-functions="update_settings,update,render" data-classes="SysFont"><pre><code>def update_settings(self, **settings):
    self.__dict__.update(settings)
    # Creates text surface
    self.font_type = pygame.font.SysFont(self.font, self.size)
    self.surface = self.font_type.render(self.text, 1, self.colour)

    # Sets the rect
    if anchor in self.available_anchors:
        try:
            exec('self.rect = self.surface.get_rect(' + self.anchor + '=self.position)')
        except TypeError:
            raise Exception(f'Invalid position {self.position}')
    else:
        raise Exception(f'Invalid anchor point {self.anchor}')</code></pre></div>

      <h2><a name='changing_text' id='changing_text'></a>Changing Text:</h2>

      <p>
        Though the use of this class, I have found that most of the time the only thing that needs updating is the text itself.
        Because of this, I find it helpful to have another method specifically for changing only the text.
        Here we can make use of variable arguments, this allows us to pass any number of items to the function, and each will be turned into a string and have a space put between them.
        This is the same way that the <code>print</code> function works.
        Since we are only interesting in changing the text, there is no need to get a new font type, only to render the new text.
      </p>

      <div class="highlight" data-functions="set_text,render"><pre><code>def set_text(self, *text):
    self.text = ''

    for item in text:  # Joins all items passed with spaces
        self.text += str(item) + ' '

    self.text = self.text[:-1]  # Removes the space off the end of the string

    # Render the new text
    self.surface = self.font_type.render(self.text, 1, self.colour)

    # Get the new rect
    if anchor in self.available_anchors:
        try:
            exec('self.rect = self.surface.get_rect(' + self.anchor + '=self.position)')
        except TypeError:
            raise Exception(f'Invalid position {self.position}')
    else:
        raise Exception(f'Invalid anchor point {self.anchor}')</code></pre></div>

      <h2><a name='code_download' id='code_download'></a>Code Download:</h2>

      <p>
        The source code can be downloaded here: <a download href='files/text.zip' target='_blank'>text.zip</a>
      </p>

      <div class='background'></div>

    </div>
  </body>
</html>